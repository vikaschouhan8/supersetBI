{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[23,26,27,28,29,30,31,33],{1298:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return c});var n=r(1),a=r.n(n),o=r(1814),i=r.n(o);r(2083),r(1831);function c(e){return a.a.createElement(\"span\",{className:\"BootstrapSliderWrapper\"},a.a.createElement(i.a,e))}},1831:function(e,t,r){},194:function(e,t,r){\"use strict\";r.d(t,\"c\",function(){return p}),r.d(t,\"b\",function(){return b}),r.d(t,\"d\",function(){return y}),r.d(t,\"e\",function(){return h}),r.d(t,\"a\",function(){return m});var n=r(11),a=r.n(n),o=r(262),i=r.n(o),c=r(569),s=r(202);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var l=8e3;function p(e){var t=e.slice;return t?t.slice_id:0}var f=0;function d(){var e=0;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(e=f%c.b.length,f+=1),c.b[e]}function b(e,t,r){if(null==e)return null;var n=r?\"annotation_json\":\"slice_json\";return i()(window.location.search).pathname(\"/superset/\".concat(n,\"/\").concat(e)).search({form_data:Object(s.safeStringify)(t,function(e,t){return null===t?void 0:t})}).toString()}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"base\",r=\"/superset/explore/\";return[\"json\",\"csv\",\"query\",\"results\",\"samples\"].indexOf(t)>=0&&(r=\"/superset/explore_json/\"),r}function y(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e.datasource)return null;var a=new i.a(\"/\"),o=g(e,t),c=a.search(!0);Object.keys(n).forEach(function(e){c[e]=n[e]}),c.form_data=Object(s.safeStringify)(e),\"standalone\"===t&&(c.standalone=\"true\");var u=a.directory(o).search(c).toString();return!r&&u.length>l?y({datasource:e.datasource,viz_type:e.viz_type},t,!1,{URL_IS_TOO_LONG_TO_SHARE:null}):u}function h(e){var t=e.formData,r=e.endpointType,n=void 0===r?\"base\":r,o=e.force,c=void 0!==o&&o,l=e.curUrl,p=void 0===l?null:l,f=e.requestParams,b=void 0===f?{}:f,y=e.allowDomainSharding,h=void 0!==y&&y,m=e.method,v=void 0===m?\"POST\":m;if(!t.datasource)return null;var O=new i.a({protocol:location.protocol.slice(0,-1),hostname:d(h),port:location.port?location.port:\"\",path:\"/\"});p&&(O=i()(i()(p).search()));var j=g(t,n),w=O.search(!0),_=t.slice_id,P=t.extra_filters,C=t.adhoc_filters,k=t.viz_type;if(_){var S={slice_id:_};\"GET\"===v&&(S.viz_type=k,P&&P.length&&(S.extra_filters=P),C&&C.length&&(S.adhoc_filters=C)),w.form_data=Object(s.safeStringify)(S)}c&&(w.force=\"true\"),\"csv\"===n&&(w.csv=\"true\"),\"standalone\"===n&&(w.standalone=\"true\"),\"query\"===n&&(w.query=\"true\"),\"results\"===n&&(w.results=\"true\"),\"samples\"===n&&(w.samples=\"true\");var E=Object.keys(b);E.length&&E.forEach(function(e){b.hasOwnProperty(e)&&(w[e]=b[e])}),O=O.search(w).directory(j);var D=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t);return{url:O.toString(),payload:D}}function m(e,t){var r=h({formData:e,endpointType:t,allowDomainSharding:!1}),n=r.url,a=r.payload,o=document.createElement(\"form\");o.action=n,o.method=\"POST\",o.target=\"_blank\";var i=document.createElement(\"input\");i.type=\"hidden\",i.name=\"csrf_token\",i.value=(document.getElementById(\"csrf_token\")||{}).value,o.appendChild(i);var c=document.createElement(\"input\");c.type=\"hidden\",c.name=\"form_data\",c.value=Object(s.safeStringify)(a),o.appendChild(c),document.body.appendChild(o),o.submit(),document.body.removeChild(o)}},202:function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.safeStringify=function(e){var t=new Set;return JSON.stringify(e,function(e,r){if(\"object\"==typeof r&&null!==r){if(t.has(r))try{return JSON.parse(JSON.stringify(r))}catch(e){return}t.add(r)}return r})}},2588:function(e,t,r){\"use strict\";r.d(t,\"b\",function(){return f}),r.d(t,\"a\",function(){return d}),r.d(t,\"c\",function(){return g});var n=r(11),a=r.n(n),o=r(2786),i=r(22),c=r(2589);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var u=.25,l={LAT_MIN:-90,LAT_MAX:90,LNG_MIN:-180,LNG_MAX:180};function p(e){var t=i.extent(e,function(e){return e[1]}),r=i.extent(e,function(e){return e[0]}),n=t[0]===t[1]?function(e){return[e[0]-u<l.LAT_MIN?l.LAT_MIN:e[0]-u,e[1]+u>l.LAT_MAX?l.LAT_MAX:e[1]+u]}(t):t,a=r[0]===r[1]?function(e){return[e[0]-u<l.LNG_MIN?l.LNG_MIN:e[0]-u,e[1]+u>l.LNG_MAX?l.LNG_MAX:e[1]+u]}(r):r;return[[a[0],n[0]],[a[1],n[1]]]}function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var n=p(t);return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e,{},Object(o.a)({height:e.height,width:e.width,padding:r,bounds:n}))}catch(t){return console.error(\"Could not auto zoom\",t),e}}function d(e,t,r,n){var a,o,i=e,s=r;return i.js_tooltip&&(s=Object(c.a)(i.js_tooltip)),s&&(a=function(e){e.picked?t({content:s(e),x:e.x,y:e.y+30}):t(null)}),i.js_onclick_href?o=function(e){var t=Object(c.a)(i.js_onclick_href)(e);window.open(t)}:i.table_filter&&void 0!==n&&(o=function(e){return n(e.object[i.line_column])}),{onClick:o,onHover:a,pickable:Boolean(a)}}var b={p1:.01,p5:.05,p95:.95,p99:.99};function g(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"sum\",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return\"count\"===t?function(e){return e.length}:(e=t in b?function(e,n){var a;return a=r?e.sort(function(e,t){return i.ascending(r(e),r(t))}):e.sort(i.ascending),i.quantile(a,b[t],n)}:i[t],r?function(t){return e(t.map(r))}:function(t){return e(t)})}},2589:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return d});var n=r(11),a=r.n(n),o=r(2622),i=r.n(o),c=r(2623),s=r.n(c),u=r(22),l=r(2592);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var f={console:console,_:s.a,colors:l,d3array:u};function d(e,t,r){var n={},o=\"SAFE_EVAL_\"+Math.floor(1e6*Math.random());n[o]={};var c=o+\"=\"+e,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},f,{},t);Object.keys(s).forEach(function(e){n[e]=s[e]});try{return i.a.runInNewContext(c,n,r),n[o]}catch(e){return function(){return e}}}},2592:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"hexToRGB\",function(){return a});var n=r(59);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;if(!e)return[0,0,0,t];var r=Object(n.f)(e);return[r.r,r.g,r.b,t]}},2596:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return x});var n=r(55),a=r.n(n),o=r(11),i=r.n(o),c=r(13),s=r.n(c),u=r(17),l=r.n(u),p=r(14),f=r.n(p),d=r(15),b=r.n(d),g=r(10),y=r.n(g),h=r(16),m=r.n(h),v=r(237),O=r.n(v),j=r(1),w=r.n(j),_=r(0),P=r.n(_),C=r(2616),k=r(2597);r(2618),r(2605);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(r,!0).forEach(function(t){i()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var D=2e3,V={viewport:P.a.object.isRequired,layers:P.a.array.isRequired,setControlValue:P.a.func,mapStyle:P.a.string,mapboxApiAccessToken:P.a.string.isRequired,onViewportChange:P.a.func},x=function(e){function t(e){var r;return s()(this,t),(r=f()(this,b()(t).call(this,e))).tick=r.tick.bind(y()(r)),r.onViewportChange=r.onViewportChange.bind(y()(r)),r.state={previousViewport:e.viewport,timer:setInterval(r.tick,D)},r}return m()(t,e),l()(t,[{key:\"componentWillUnmount\",value:function(){clearInterval(this.state.timer)}},{key:\"onViewportChange\",value:function(e){var t=Object.assign({},e),r=E({},this.state.previousViewport,{},t);this.props.onViewportChange(r)}},{key:\"tick\",value:function(){var e=this;if(this.state&&!O()(this.state.previousViewport,this.props.viewport)){var t=this.props.setControlValue,r=this.props.viewport;t&&t(\"viewport\",r),this.setState(function(){return{previousViewport:e.props.viewport}})}}},{key:\"layers\",value:function(){return this.props.layers.some(function(e){return\"function\"==typeof e})?this.props.layers.map(function(e){return\"function\"==typeof e?e():e}):this.props.layers}},{key:\"render\",value:function(){var e=this.props.viewport;return w.a.createElement(C.b,a()({},e,{mapStyle:this.props.mapStyle,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiAccessToken}),w.a.createElement(k.i,a()({},e,{layers:this.layers(),initWebGLParameters:!0})))}}],[{key:\"getDerivedStateFromProps\",value:function(e,t){return e.viewport!==t.viewport?{viewport:E({},e.viewport),previousViewport:t.viewport}:null}}]),t}(w.a.Component);x.propTypes=V,x.defaultProps={mapStyle:\"light\",onViewportChange:function(){},setControlValue:function(){}}},2599:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return m});var n=r(13),a=r.n(n),o=r(17),i=r.n(o),c=r(14),s=r.n(c),u=r(15),l=r.n(u),p=r(16),f=r.n(p),d=r(1),b=r.n(d),g=r(0),y=r.n(g),h={label:y.a.string.isRequired,value:y.a.string.isRequired},m=function(e){function t(){return a()(this,t),s()(this,l()(t).apply(this,arguments))}return f()(t,e),i()(t,[{key:\"render\",value:function(){return b.a.createElement(\"div\",null,this.props.label,b.a.createElement(\"strong\",null,this.props.value))}}]),t}(b.a.PureComponent);m.propTypes=h},2605:function(e,t,r){},2606:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return u});var n=r(48),a=r.n(n),o=r(8),i=r.n(o),c=[1,0,1,0,0,0,0];function s(e,t){var r=parseInt(i()(t).format(\"x\"),10);return parseInt(i()(t).add(e).format(\"x\"),10)-r}var u=function(e,t){var r,n,o=i()(Math.min.apply(Math,a()(e))),u=i()(Math.max.apply(Math,a()(e)));if(-1!==t.indexOf(\"/\")){var l=t.split(\"/\",2);l[0].endsWith(\"Z\")?(n=i()(l[0]),r=i.a.duration(l[1])):(n=i()(l[1]),r=i.a.duration(l[0]))}else n=function(e,t){var r=i()(e).subtract(t),n=e.toArray(),a=r.toArray(),o=n.map(function(e,t){return a[t]!==e}).indexOf(!0),s=n.map(function(e,t){if(t===o){var r=e-a[t];return e-(e-c[t])%r}return t<o||-1===o?e:c[t]});return i()(s)}(o,r=i.a.duration(t));for(var p=i()(n);p<o;)p.add(r);for(;p>o;)p.subtract(r);for(var f=i()(n);f>u;)f.subtract(r);for(;f<u;)f.add(r);var d=null!=t?[p,i()(p).add(r)]:[p,f],b=e.every(function(e){return null===e});return{start:parseInt(p.format(\"x\"),10),end:parseInt(f.format(\"x\"),10),getStep:s.bind(this,r),values:d.map(function(e){return parseInt(e.format(\"x\"),10)}),disabled:b}}},2607:function(e,t,r){\"use strict\";var n=r(11),a=r.n(n),o=r(13),i=r.n(o),c=r(17),s=r.n(c),u=r(14),l=r.n(u),p=r(15),f=r.n(p),d=r(10),b=r.n(d),g=r(16),y=r.n(g),h=r(1),m=r.n(h),v=r(0),O=r.n(v),j=r(2596),w=r(1299),_=r.n(w),P=r(35),C=r(1298),k=(r(2608),{start:O.a.number.isRequired,step:O.a.number.isRequired,end:O.a.number.isRequired,values:O.a.array.isRequired,onChange:O.a.func,loopDuration:O.a.number,maxFrames:O.a.number,orientation:O.a.oneOf([\"horizontal\",\"vertical\"]),reversed:O.a.bool,disabled:O.a.bool,range:O.a.bool}),S=function(e){function t(e){var r;i()(this,t),(r=l()(this,f()(t).call(this,e))).state={intervalId:null};var n=e.end-e.start,a=Math.min(e.maxFrames,n/e.step),o=n/a;return r.intervalMilliseconds=e.loopDuration/a,r.increment=o<e.step?e.step:o-o%e.step,r.onChange=r.onChange.bind(b()(r)),r.play=r.play.bind(b()(r)),r.pause=r.pause.bind(b()(r)),r.stepBackward=r.stepBackward.bind(b()(r)),r.stepForward=r.stepForward.bind(b()(r)),r.getPlayClass=r.getPlayClass.bind(b()(r)),r.formatter=r.formatter.bind(b()(r)),r}return y()(t,e),s()(t,[{key:\"componentDidMount\",value:function(){_.a.bind([\"space\"],this.play)}},{key:\"componentWillUnmount\",value:function(){_.a.unbind([\"space\"])}},{key:\"onChange\",value:function(e){this.props.onChange(e.target.value),null!=this.state.intervalId&&this.pause()}},{key:\"getPlayClass\",value:function(){return null==this.state.intervalId?\"fa fa-play fa-lg slider-button\":\"fa fa-pause fa-lg slider-button\"}},{key:\"play\",value:function(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{var e=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:e})}}},{key:\"pause\",value:function(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}},{key:\"stepForward\",value:function(){var e=this,t=this.props,r=t.start,n=t.end,a=t.step,o=t.values;if(!t.disabled){var i=(Array.isArray(o)?o:[o,o+a]).map(function(t){return t+e.increment}),c=i[1]>n?i[0]-r:0;this.props.onChange(i.map(function(e){return e-c}))}}},{key:\"stepBackward\",value:function(){var e=this,t=this.props,r=t.start,n=t.end,a=t.step,o=t.values;if(!t.disabled){var i=(Array.isArray(o)?o:[o,o+a]).map(function(t){return t-e.increment}),c=i[0]<r?n-i[1]:0;this.props.onChange(i.map(function(e){return e+c}))}}},{key:\"formatter\",value:function(e){if(this.props.disabled)return Object(P.b)(\"Data has no time steps\");var t=e;return Array.isArray(e)?e[0]===e[1]&&(t=[e[0]]):t=[e],t.map(function(e){return new Date(e).toUTCString()}).join(\" : \")}},{key:\"render\",value:function(){var e=this.props,t=e.start,r=e.end,n=e.step,a=e.orientation,o=e.reversed,i=e.disabled,c=e.range,s=e.values;return m.a.createElement(\"div\",{className:\"play-slider\"},m.a.createElement(\"div\",{className:\"play-slider-controls padded\"},m.a.createElement(\"i\",{className:\"fa fa-step-backward fa-lg slider-button \",onClick:this.stepBackward}),m.a.createElement(\"i\",{className:this.getPlayClass(),onClick:this.play}),m.a.createElement(\"i\",{className:\"fa fa-step-forward fa-lg slider-button \",onClick:this.stepForward})),m.a.createElement(\"div\",{className:\"play-slider-scrobbler padded\"},m.a.createElement(C.a,{value:c?s:s[0],range:c,formatter:this.formatter,change:this.onChange,min:t,max:r,step:n,orientation:a,reversed:o,disabled:i?\"disabled\":\"enabled\"})))}}]),t}(m.a.PureComponent);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}S.propTypes=k,S.defaultProps={onChange:function(){},loopDuration:15e3,maxFrames:100,orientation:\"horizontal\",reversed:!1,disabled:!1,range:!0},r.d(t,\"a\",function(){return x});var V={getLayers:O.a.func.isRequired,start:O.a.number.isRequired,end:O.a.number.isRequired,getStep:O.a.func,values:O.a.array.isRequired,aggregation:O.a.bool,disabled:O.a.bool,viewport:O.a.object.isRequired,children:O.a.node,mapStyle:O.a.string,mapboxApiAccessToken:O.a.string.isRequired,setControlValue:O.a.func,onViewportChange:O.a.func,onValuesChange:O.a.func},x=function(e){function t(e){var r;return i()(this,t),(r=l()(this,f()(t).call(this,e))).onViewportChange=r.onViewportChange.bind(b()(r)),r}return y()(t,e),s()(t,[{key:\"onViewportChange\",value:function(e){var t=this.props.disabled?D({},e):D({},e,{height:e.height+20});this.props.onViewportChange(t)}},{key:\"render\",value:function(){var e=this.props,t=e.start,r=e.end,n=e.getStep,a=e.disabled,o=e.aggregation,i=e.children,c=e.getLayers,s=e.values,u=e.onValuesChange,l=e.viewport,p=e.setControlValue,f=e.mapStyle,d=e.mapboxApiAccessToken,b=c(s),g=D({},l,{height:a?l.height:l.height-20});return m.a.createElement(\"div\",null,m.a.createElement(j.a,{viewport:g,layers:b,setControlValue:p,mapStyle:f,mapboxApiAccessToken:d,onViewportChange:this.onViewportChange}),!a&&m.a.createElement(S,{start:t,end:r,step:n(t),values:s,range:!o,onChange:u}),i)}}]),t}(m.a.Component);x.propTypes=V,x.defaultProps={aggregation:!1,disabled:!1,mapStyle:\"light\",setControlValue:function(){},onViewportChange:function(){},onValuesChange:function(){}}},2608:function(e,t,r){},2609:function(e,t,r){\"use strict\";var n=r(11),a=r.n(n),o=r(13),i=r.n(o),c=r(17),s=r.n(c),u=r(14),l=r.n(u),p=r(15),f=r.n(p),d=r(10),b=r.n(d),g=r(16),y=r.n(g),h=r(237),m=r.n(h),v=r(1),O=r.n(v),j=r(0),w=r.n(j),_=r(2596),P=r(48),C=r.n(P),k=r(177),S=r(2607),E=r(2611),D=r(2592),V=r(2606),x=r(2589),A=r(2588);function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var R=k.CategoricalColorNamespace.getScale;var q={formData:w.a.object.isRequired,mapboxApiKey:w.a.string.isRequired,setControlValue:w.a.func.isRequired,viewport:w.a.object.isRequired,getLayer:w.a.func.isRequired,getPoints:w.a.func.isRequired,payload:w.a.object.isRequired,onAddFilter:w.a.func,setTooltip:w.a.func},F=function(e){function t(e){var r;return i()(this,t),(r=l()(this,f()(t).call(this,e))).state=r.getStateFromProps(e),r.getLayers=r.getLayers.bind(b()(r)),r.onValuesChange=r.onValuesChange.bind(b()(r)),r.onViewportChange=r.onViewportChange.bind(b()(r)),r.toggleCategory=r.toggleCategory.bind(b()(r)),r.showSingleCategory=r.showSingleCategory.bind(b()(r)),r}return y()(t,e),s()(t,[{key:\"componentWillReceiveProps\",value:function(e){e.payload.form_data!==this.state.formData&&this.setState(T({},this.getStateFromProps(e)))}},{key:\"onValuesChange\",value:function(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})}},{key:\"onViewportChange\",value:function(e){this.setState({viewport:e})}},{key:\"getStateFromProps\",value:function(e,t){var r=e.payload.data.features||[],n=r.map(function(e){return e.__timestamp}),a=function(e,t){var r=e.color_picker||{r:0,g:0,b:0,a:1},n=[r.r,r.g,r.b,255*r.a],a=R(e.color_scheme),o={};return t.forEach(function(t){var i;null==t.cat_color||o.hasOwnProperty(t.cat_color)||(i=e.dimension?Object(D.hexToRGB)(a(t.cat_color),255*r.a):n,o[t.cat_color]={color:i,enabled:!0})}),o}(e.formData,r);if(t&&e.payload.form_data===t.formData)return T({},t,{categories:a});var o=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||\"P1D\",i=Object(V.a)(n,o);return{start:i.start,end:i.end,getStep:i.getStep,values:i.values,disabled:i.disabled,viewport:e.formData.autozoom?Object(A.b)(e.viewport,e.getPoints(r)):e.viewport,selected:[],lastClick:0,formData:e.payload.form_data,categories:a}}},{key:\"getLayers\",value:function(e){var t=this.props,r=t.getLayer,n=t.payload,a=t.formData,o=t.onAddFilter,i=t.setTooltip,c=n.data.features?C()(n.data.features):[];(c=this.addColor(c,a),a.js_data_mutator)&&(c=Object(x.a)(a.js_data_mutator)(c));c=e[0]===e[1]||e[1]===this.end?c.filter(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):c.filter(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]});var s=this.state.categories;return a.dimension&&(c=c.filter(function(e){return s[e.cat_color]&&s[e.cat_color].enabled})),[r(a,T({},n,{data:T({},n.data,{features:c})}),o,i)]}},{key:\"addColor\",value:function(e,t){var r=t.color_picker||{r:0,g:0,b:0,a:1},n=R(t.color_scheme);return e.map(function(e){return t.dimension?T({},e,{color:Object(D.hexToRGB)(n(e.cat_color),255*r.a)}):e})}},{key:\"toggleCategory\",value:function(e){var t=this.state.categories[e],r=T({},this.state.categories,a()({},e,T({},t,{enabled:!t.enabled})));Object.values(r).every(function(e){return!e.enabled})&&Object.values(r).forEach(function(e){e.enabled=!0}),this.setState({categories:r})}},{key:\"showSingleCategory\",value:function(e){var t=T({},this.state.categories);Object.values(t).forEach(function(e){e.enabled=!1}),t[e].enabled=!0,this.setState({categories:t})}},{key:\"render\",value:function(){return O.a.createElement(\"div\",{style:{position:\"relative\"}},O.a.createElement(S.a,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,onValuesChange:this.onValuesChange,disabled:this.state.disabled,viewport:this.state.viewport,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiKey,mapStyle:this.props.formData.mapbox_style,setControlValue:this.props.setControlValue},O.a.createElement(E.a,{categories:this.state.categories,toggleCategory:this.toggleCategory,showSingleCategory:this.showSingleCategory,position:this.props.formData.legend_position,format:this.props.formData.legend_format})))}}]),t}(O.a.PureComponent);function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}F.propTypes=q,r.d(t,\"b\",function(){return B}),r.d(t,\"a\",function(){return G});var I={formData:w.a.object.isRequired,payload:w.a.object.isRequired,setControlValue:w.a.func.isRequired,viewport:w.a.object.isRequired,onAddFilter:w.a.func,setTooltip:w.a.func},z={onAddFilter:function(){},setTooltip:function(){}};function B(e,t){var r=function(r){function n(e){var r;i()(this,n),r=l()(this,f()(n).call(this,e));var a=e.viewport,o=e.formData.autozoom?Object(A.b)(a,t(e.payload.data.features)):a;return r.state={viewport:o,layer:r.computeLayer(e)},r.onViewportChange=r.onViewportChange.bind(b()(r)),r}return y()(n,r),s()(n,[{key:\"componentWillReceiveProps\",value:function(e){var t=N({},e.formData,{viewport:null}),r=N({},this.props.formData,{viewport:null});m()(t,r)&&e.payload===this.props.payload||this.setState({layer:this.computeLayer(e)})}},{key:\"onViewportChange\",value:function(e){this.setState({viewport:e})}},{key:\"computeLayer\",value:function(t){var r=t.formData,n=t.payload,a=t.onAddFilter,o=t.setTooltip;return e(r,n,a,o)}},{key:\"render\",value:function(){var e=this.props,t=e.formData,r=e.payload,n=e.setControlValue,a=this.state,o=a.layer,i=a.viewport;return O.a.createElement(_.a,{mapboxApiAccessToken:r.data.mapboxApiKey,viewport:i,layers:[o],mapStyle:t.mapbox_style,setControlValue:n,onViewportChange:this.onViewportChange})}}]),n}(O.a.PureComponent);return r.propTypes=I,r.defaultProps=z,r}function G(e,t){function r(r){var n=r.formData,a=r.payload,o=r.setControlValue,i=r.onAddFilter,c=r.setTooltip,s=r.viewport;return O.a.createElement(F,{formData:n,mapboxApiKey:a.data.mapboxApiKey,setControlValue:o,viewport:s,getLayer:e,payload:a,onAddFilter:i,setTooltip:c,getPoints:t})}return r.propTypes=I,r.defaultProps=z,r}},2611:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return _});var n=r(11),a=r.n(n),o=r(90),i=r.n(o),c=r(13),s=r.n(c),u=r(17),l=r.n(u),p=r(14),f=r.n(p),d=r(15),b=r.n(d),g=r(16),y=r.n(g),h=r(1),m=r.n(h),v=r(0),O=r.n(v),j=r(567),w=(r(2612),{categories:O.a.object,toggleCategory:O.a.func,showSingleCategory:O.a.func,format:O.a.string,position:O.a.oneOf([null,\"tl\",\"tr\",\"bl\",\"br\"])}),_=function(e){function t(){return s()(this,t),f()(this,b()(t).apply(this,arguments))}return y()(t,e),l()(t,[{key:\"format\",value:function(e){if(!this.props.format)return e;var t=parseFloat(e);return Object(j.b)(this.props.format,t)}},{key:\"formatCategoryLabel\",value:function(e){if(!this.props.format)return e;if(e.includes(\" - \")){var t=e.split(\" - \");return this.format(t[0])+\" - \"+this.format(t[1])}return this.format(e)}},{key:\"render\",value:function(){var e,t=this;if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;var r=Object.entries(this.props.categories).map(function(e){var r=i()(e,2),n=r[0],a=r[1],o={color:\"rgba(\"+a.color.join(\", \")+\")\"},c=a.enabled?\"◼\":\"◻\";return m.a.createElement(\"li\",{key:n},m.a.createElement(\"a\",{href:\"#\",onClick:function(){return t.props.toggleCategory(n)},onDoubleClick:function(){return t.props.showSingleCategory(n)}},m.a.createElement(\"span\",{style:o},c),\" \",t.formatCategoryLabel(n)))}),n=\"t\"===this.props.position.charAt(0)?\"top\":\"bottom\",o=\"r\"===this.props.position.charAt(1)?\"right\":\"left\",c=(e={position:\"absolute\"},a()(e,n,\"0px\"),a()(e,o,\"10px\"),e);return m.a.createElement(\"div\",{className:\"legend\",style:c},m.a.createElement(\"ul\",{className:\"categories\"},r))}}]),t}(m.a.PureComponent);_.propTypes=w,_.defaultProps={categories:{},toggleCategory:function(){},showSingleCategory:function(){},format:null,position:\"tr\"}},2612:function(e,t,r){},2619:function(e,t){},2620:function(e,t){},2621:function(e,t){},2674:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"getLayer\",function(){return d});var n=r(11),a=r.n(n),o=r(2597),i=r(1),c=r.n(i),s=r(35),u=r(2588),l=r(2609),p=r(2599);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e,t,r,n){var i,l=t.data.features,d=e.color_picker,b=e.target_color_picker;return new o.a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({id:\"path-layer-\".concat(e.slice_id),data:l,getSourceColor:function(e){return e.sourceColor||e.color||[d.r,d.g,d.b,255*d.a]},getTargetColor:function(e){return e.targetColor||e.color||[b.r,b.g,b.b,255*b.a]},strokeWidth:e.stroke_width?e.stroke_width:3},Object(u.a)(e,n,(i=e,function(e){return c.a.createElement(\"div\",{className:\"deckgl-tooltip\"},c.a.createElement(p.a,{label:\"\".concat(Object(s.b)(\"Start (Longitude, Latitude)\"),\": \"),value:\"\".concat(e.object.sourcePosition[0],\", \").concat(e.object.sourcePosition[1])}),c.a.createElement(p.a,{label:\"\".concat(Object(s.b)(\"End (Longitude, Latitude)\"),\": \"),value:\"\".concat(e.object.targetPosition[0],\", \").concat(e.object.targetPosition[1])}),i.dimension&&c.a.createElement(p.a,{label:\"\".concat(i.dimension,\": \"),value:\"\".concat(e.object.cat_color)}))}))))}t.default=Object(l.a)(d,function(e){var t=[];return e.forEach(function(e){t.push(e.sourcePosition),t.push(e.targetPosition)}),t})},2697:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"getLayer\",function(){return w});var n=r(11),a=r.n(n),o=r(1),i=r.n(o),c=r(0),s=r.n(c),u=r(2597),l=r(2596),p=r(2592),f=r(2589),d=r(2588),b=r(2599);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var h,m={fillColor:\"fillColor\",color:\"fillColor\",fill:\"fillColor\",\"fill-color\":\"fillColor\",strokeColor:\"strokeColor\",\"stroke-color\":\"strokeColor\",\"stroke-width\":\"strokeWidth\"},v=function(e,t){var r={};return Object.keys(e).forEach(function(t){t in m?r[m[t]]=e[t]:r[t]=e[t]}),\"string\"==typeof e.fillColor&&(r.fillColor=Object(p.hexToRGB)(e.fillColor)),\"string\"==typeof e.strokeColor&&(r.strokeColor=Object(p.hexToRGB)(e.strokeColor)),y({},r,{},t)},O=function e(t,r,n){if(t&&t.features&&t.features.forEach(function(a){e(a,r,t.extraProps||n)}),t&&t.geometry){var a=y({},t,{properties:v(t.properties,r)});a.extraProps||(a.extraProps=n),h.push(a)}};function j(e){return e.object.extraProps&&i.a.createElement(\"div\",{className:\"deckgl-tooltip\"},Object.keys(e.object.extraProps).map(function(t,r){return i.a.createElement(b.a,{key:\"prop-\".concat(r),label:\"\".concat(t,\": \"),value:\"\".concat(e.object.extraProps[t])})}))}function w(e,t,r,n){var a,o=e,i=o.fill_color_picker,c=o.stroke_color_picker,s=[i.r,i.g,i.b,255*i.a],l=[c.r,c.g,c.b,255*c.a],p={};return s[3]>0&&(p.fillColor=s),l[3]>0&&(p.strokeColor=l),h=[],O(t.data,p),o.js_data_mutator&&(a=Object(f.a)(o.js_data_mutator),h=a(h)),new u.b(y({id:\"geojson-layer-\".concat(o.slice_id),filled:o.filled,data:h,stroked:o.stroked,extruded:o.extruded,pointRadiusScale:o.point_radius_scale},Object(d.a)(o,n,j)))}var _={formData:s.a.object.isRequired,payload:s.a.object.isRequired,setControlValue:s.a.func.isRequired,viewport:s.a.object.isRequired,onAddFilter:s.a.func,setTooltip:s.a.func};function P(e){var t=e.formData,r=e.payload,n=e.setControlValue,a=(e.onAddFilter,e.setTooltip),o=e.viewport,c=w(t,r,0,a);return i.a.createElement(l.a,{mapboxApiAccessToken:r.data.mapboxApiKey,viewport:o,layers:[c],mapStyle:t.mapbox_style,setControlValue:n})}P.propTypes=_,P.defaultProps={onAddFilter:function(){},setTooltip:function(){}},t.default=P},2698:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"getLayer\",function(){return y});var n=r(11),a=r.n(n),o=r(2597),i=r(1),c=r.n(i),s=r(35),u=r(2588),l=r(2589),p=r(2609),f=r(2599);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(e){return c.a.createElement(\"div\",{className:\"deckgl-tooltip\"},c.a.createElement(f.a,{label:\"\".concat(Object(s.b)(\"Longitude and Latitude\"),\": \"),value:\"\".concat(e.object.position[0],\", \").concat(e.object.position[1])}),c.a.createElement(f.a,{label:\"\".concat(Object(s.b)(\"Height\"),\": \"),value:\"\".concat(e.object.elevationValue)}))}function y(e,t,r,n){var a=e,i=a.color_picker,c=t.data.features.map(function(e){return b({},e,{color:[i.r,i.g,i.b,255*i.a]})});a.js_data_mutator&&(c=Object(l.a)(a.js_data_mutator)(c));var s=Object(u.c)(a.js_agg_function,function(e){return e.weight});return new o.c(b({id:\"grid-layer-\".concat(a.slice_id),data:c,pickable:!0,cellSize:a.grid_size,minColor:[0,0,0,0],extruded:a.extruded,maxColor:[i.r,i.g,i.b,255*i.a],outline:!1,getElevationValue:s,getColorValue:s},Object(u.a)(a,n,g)))}t.default=Object(p.b)(y,function(e){return e.map(function(e){return e.position})})},2699:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"getLayer\",function(){return y});var n=r(11),a=r.n(n),o=r(2597),i=r(1),c=r.n(i),s=r(35),u=r(2588),l=r(2589),p=r(2609),f=r(2599);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(e){return c.a.createElement(\"div\",{className:\"deckgl-tooltip\"},c.a.createElement(f.a,{label:\"\".concat(Object(s.b)(\"Centroid (Longitude and Latitude)\"),\": \"),value:\"(\".concat(e.object.centroid[0],\", \").concat(e.object.centroid[1],\")\")}),c.a.createElement(f.a,{label:\"\".concat(Object(s.b)(\"Height\"),\": \"),value:\"\".concat(e.object.elevationValue)}))}function y(e,t,r,n){var a=e,i=a.color_picker,c=t.data.features.map(function(e){return b({},e,{color:[i.r,i.g,i.b,255*i.a]})});a.js_data_mutator&&(c=Object(l.a)(a.js_data_mutator)(c));var s=Object(u.c)(a.js_agg_function,function(e){return e.weight});return new o.d(b({id:\"hex-layer-\".concat(a.slice_id),data:c,pickable:!0,radius:a.grid_size,minColor:[0,0,0,0],extruded:a.extruded,maxColor:[i.r,i.g,i.b,255*i.a],outline:!1,getElevationValue:s,getColorValue:s},Object(u.a)(a,n,g)))}t.default=Object(p.b)(y,function(e){return e.map(function(e){return e.position})})},2700:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"getLayer\",function(){return x});var n=r(13),a=r.n(n),o=r(17),i=r.n(o),c=r(14),s=r.n(c),u=r(15),l=r.n(u),p=r(10),f=r.n(p),d=r(16),b=r.n(d),g=r(11),y=r.n(g),h=r(1),m=r.n(h),v=r(0),O=r.n(v),j=r(2597),w=r(35),_=r(2607),P=r(2606),C=r(2589),k=r(2588),S=r(2599);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(r,!0).forEach(function(t){y()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function V(e){return m.a.createElement(\"div\",{className:\"deckgl-tooltip\"},m.a.createElement(S.a,{label:\"\".concat(Object(w.b)(\"Longitude and Latitude\"),\": \"),value:\"\".concat(e.object.position[0],\", \").concat(e.object.position[1])}),m.a.createElement(S.a,{label:\"\".concat(Object(w.b)(\"Weight\"),\": \"),value:\"\".concat(e.object.weight)}))}function x(e,t,r,n,a,o,i){var c=e,s=c.color_picker,u=t.data.features.map(function(e){return D({},e,{color:[s.r,s.g,s.b,255*s.a]})});if(c.js_data_mutator){var l=Object(C.a)(c.js_data_mutator);u=l(u)}return null!=i&&i.forEach(function(e){u=u.filter(e)}),new j.h(D({id:\"screengrid-layer-\".concat(c.slice_id),data:u,pickable:!0,cellSizePixels:c.grid_size,minColor:[s.r,s.g,s.b,0],maxColor:[s.r,s.g,s.b,255*s.a],outline:!1,getWeight:function(e){return e.weight||0}},Object(k.a)(c,n,V)))}var A={formData:O.a.object.isRequired,payload:O.a.object.isRequired,setControlValue:O.a.func.isRequired,viewport:O.a.object.isRequired,onAddFilter:O.a.func,setTooltip:O.a.func},L=function(e){function t(e){var r;return a()(this,t),(r=s()(this,l()(t).call(this,e))).state=t.getDerivedStateFromProps(e),r.getLayers=r.getLayers.bind(f()(r)),r.onValuesChange=r.onValuesChange.bind(f()(r)),r.onViewportChange=r.onViewportChange.bind(f()(r)),r}return b()(t,e),i()(t,[{key:\"onValuesChange\",value:function(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})}},{key:\"onViewportChange\",value:function(e){this.setState({viewport:e})}},{key:\"getLayers\",value:function(e){var t=[];return e[0]===e[1]||e[1]===this.end?t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]}),[x(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip)]}},{key:\"render\",value:function(){var e=this.props,t=e.formData,r=e.payload,n=e.setControlValue;return m.a.createElement(\"div\",null,m.a.createElement(_.a,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,onValuesChange:this.onValuesChange,disabled:this.state.disabled,viewport:this.state.viewport,onViewportChange:this.onViewportChange,mapboxApiAccessToken:r.data.mapboxApiKey,mapStyle:t.mapbox_style,setControlValue:n,aggregation:!0}))}}],[{key:\"getDerivedStateFromProps\",value:function(e,t){if(t&&e.payload.form_data===t.formData)return null;var r=e.payload.data.features||[],n=r.map(function(e){return e.__timestamp}),a=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||\"P1D\",o=Object(P.a)(n,a);return{start:o.start,end:o.end,getStep:o.getStep,values:o.values,disabled:o.disabled,viewport:e.formData.autozoom?Object(k.b)(e.viewport,r.map(function(e){return e.position})):e.viewport,selected:[],lastClick:0,formData:e.payload.form_data}}}]),t}(m.a.PureComponent);L.propTypes=A,L.defaultProps={onAddFilter:function(){},setTooltip:function(){}},t.default=L},2701:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"getLayer\",function(){return g});var n=r(11),a=r.n(n),o=r(2597),i=r(1),c=r.n(i),s=r(2588),u=r(2589),l=r(2609),p=r(2599);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e){return e.object.extraProps&&c.a.createElement(\"div\",{className:\"deckgl-tooltip\"},Object.keys(e.object.extraProps).map(function(t,r){return c.a.createElement(p.a,{key:\"prop-\".concat(r),label:\"\".concat(t,\": \"),value:\"\".concat(e.object.extraProps[t])})}))}function g(e,t,r,n){var a=e,i=a.color_picker,c=[i.r,i.g,i.b,255*i.a],l=t.data.features.map(function(e){return d({},e,{path:e.path,width:a.line_width,color:c})});a.js_data_mutator&&(l=Object(u.a)(a.js_data_mutator)(l));return new o.e(d({id:\"path-layer-\".concat(a.slice_id),data:l,rounded:!0,widthScale:1},Object(s.a)(a,n,b)))}t.default=Object(l.b)(g,function(e){var t=[];return e.forEach(function(e){t=t.concat(e.path)}),t})},2702:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"getLayer\",function(){return g});var n=r(11),a=r.n(n),o=r(2597),i=r(1),c=r.n(i),s=r(35),u=r(2588),l=r(2609),p=r(2599),f=r(847);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(e,t,r,n){var a=e,i=t.data.features.map(function(e){var t=Object(f.b)(a.point_unit,e.radius)||10;if(a.multiplier&&(t*=a.multiplier),e.color)return b({},e,{radius:t});var r=a.color_picker||{r:0,g:0,b:0,a:1};return b({},e,{radius:t,color:[r.r,r.g,r.b,255*r.a]})});return new o.g(b({id:\"scatter-layer-\".concat(a.slice_id),data:i,fp64:!0,radiusMinPixels:a.min_radius||null,radiusMaxPixels:a.max_radius||null,outline:!1},Object(u.a)(a,n,function(e){return function(t){return c.a.createElement(\"div\",{className:\"deckgl-tooltip\"},c.a.createElement(p.a,{label:\"\".concat(Object(s.b)(\"Longitude and Latitude\"),\": \"),value:\"\".concat(t.object.position[0],\", \").concat(t.object.position[1])}),t.object.cat_color&&c.a.createElement(p.a,{label:\"\".concat(Object(s.b)(\"Category\"),\": \"),value:\"\".concat(t.object.cat_color)}),t.object.metric&&c.a.createElement(p.a,{label:\"\".concat(e.point_radius_fixed.value.label,\": \"),value:\"\".concat(t.object.metric)}))}}(a))))}t.default=Object(l.a)(g,function(e){return e.map(function(e){return e.position})})},2722:function(e,t,r){\"use strict\";r.r(t);var n=r(13),a=r.n(n),o=r(17),i=r.n(o),c=r(14),s=r.n(c),u=r(15),l=r.n(u),p=r(10),f=r.n(p),d=r(16),b=r.n(d),g=r(11),y=r.n(g),h=r(48),m=r.n(h),v=r(1),O=r.n(v),j=r(0),w=r.n(j),_=r(2597),P=r(2607),C=r(2611),k=r(2599),S=r(90),E=r.n(S),D=r(22),V=r(175),x=r(264),A=r(866),L=r(2592),T=10;function R(e,t,r){var n=e.break_points,a=e.num_buckets;if(!t)return[];if(void 0===n||0===n.length){var o=a?parseInt(a,10):T,i=Object(D.extent)(t,r),c=E()(i,2),s=c[0],u=c[1];if(void 0===s)return[];var l=(u-s)/o,p=0===l?0:Math.max(0,Math.ceil(Math.log10(1/l))),f=u>u.toFixed(p)?1:0;return Array(o+1+f).fill().map(function(e,t){return(s+t*l).toFixed(p)})}return n.sort(function(e,t){return parseFloat(e)-parseFloat(t)})}function q(e,t,r){var n,a,o=e.break_points,i=e.num_buckets,c=e.linear_color_scheme,s=e.opacity,u=o||i?R({break_points:o,num_buckets:i},t,r):null,l=Array.isArray(c)?new x.a({id:\"custom\",colors:c}):Object(A.a)().get(c);if(null!==u){var p=u.length-1,f=p>1?l.getColors(p):[l.colors[l.colors.length-1]],d=f[0],b=f[f.length-1];f.unshift(d),f.push(b);var g=u.map(function(e){return parseFloat(e)});n=Object(V.i)().domain(g).range(f),a=function(e){return e>u[p]||e<u[0]}}else n=l.createLinearScale(Object(D.extent)(t,r)),a=function(){return!1};return function(e){var t=r(e),o=Object(L.hexToRGB)(n(t));return a(t)?o[3]=0:o[3]=s/100*255,o}}var F=r(2588),M=r(2606),N=r(2589);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}r.d(t,\"getLayer\",function(){return z});function z(e,t,r,n,a,o,i){var c=e,s=c.fill_color_picker,u=c.stroke_color_picker,l=m()(t.data.features);if(null!=i&&i.forEach(function(e){l=l.filter(e)}),c.js_data_mutator){var p=Object(N.a)(c.js_data_mutator);l=p(l)}var f=c.metric?c.metric.label||c.metric:null,d=null===c.metric?function(){return[s.r,s.g,s.b,255*s.a]}:q(c,l,function(e){return e[f]}),b=function(e){var t=d(e);return a.length>0&&-1===a.indexOf(e[c.line_column])&&(t[3]/=2),t},g=c.line_column&&c.metric&&[\"geohash\",\"zipcode\"].indexOf(c.line_type)>=0?function(e){return function(t){var r=e.metric.label||e.metric;return O.a.createElement(\"div\",{className:\"deckgl-tooltip\"},O.a.createElement(k.a,{label:\"\".concat(e.line_column,\": \"),value:\"\".concat(t.object[e.line_column])}),e.metric&&O.a.createElement(k.a,{label:\"\".concat(r,\": \"),value:\"\".concat(t.object[r])}))}}(c):void 0;return new _.f(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(r,!0).forEach(function(t){y()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({id:\"path-layer-\".concat(c.slice_id),data:l,pickable:!0,filled:c.filled,stroked:c.stroked,getPolygon:function(e){return e.polygon},getFillColor:b,getLineColor:[u.r,u.g,u.b,255*u.a],getLineWidth:c.line_width,extruded:c.extruded,getElevation:function(e){return function(e,t){return 0===t(e)[3]?0:e.elevation}(e,b)},elevationScale:c.multiplier,fp64:!0},Object(F.a)(c,n,g,o)))}var B={formData:w.a.object.isRequired,payload:w.a.object.isRequired,setControlValue:w.a.func.isRequired,viewport:w.a.object.isRequired,onAddFilter:w.a.func,setTooltip:w.a.func},G=function(e){function t(e){var r;return a()(this,t),(r=s()(this,l()(t).call(this,e))).state=t.getDerivedStateFromProps(e),r.getLayers=r.getLayers.bind(f()(r)),r.onSelect=r.onSelect.bind(f()(r)),r.onValuesChange=r.onValuesChange.bind(f()(r)),r.onViewportChange=r.onViewportChange.bind(f()(r)),r}return b()(t,e),i()(t,[{key:\"onSelect\",value:function(e){var t=this.props,r=t.formData,n=t.onAddFilter,a=new Date,o=a-this.state.lastClick<=250,i=m()(this.state.selected);if(o)i.splice(0,i.length,e);else if(r.toggle_polygons){var c=i.indexOf(e);-1===c?i.push(e):i.splice(c,1)}else i.splice(0,1,e);this.setState({selected:i,lastClick:a}),r.table_filter&&n(r.line_column,i,!1,!0)}},{key:\"onValuesChange\",value:function(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})}},{key:\"onViewportChange\",value:function(e){this.setState({viewport:e})}},{key:\"getLayers\",value:function(e){if(void 0===this.props.payload.data.features)return[];var t=[];return e[0]===e[1]||e[1]===this.end?t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]}),[z(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip,this.state.selected,this.onSelect,t)]}},{key:\"render\",value:function(){var e=this.props,t=e.payload,r=e.formData,n=e.setControlValue,a=this.state,o=a.start,i=a.end,c=a.getStep,s=a.values,u=a.disabled,l=a.viewport,p=r,f=p.metric?p.metric.label||p.metric:null,d=function(e,t,r){var n=R(e,t,r),a=q(e,t,r),o={};return n.slice(1).forEach(function(t,r){var i=n[r]+\" - \"+n[r+1],c=.5*(parseFloat(n[r])+parseFloat(n[r+1])),s=e.metric?e.metric.label||e.metric:null;o[i]={color:a(y()({},s||e.metric,c)),enabled:!0}}),o}(r,t.data.features,function(e){return e[f]});return O.a.createElement(\"div\",{style:{position:\"relative\"}},O.a.createElement(P.a,{getLayers:this.getLayers,start:o,end:i,getStep:c,values:s,onValuesChange:this.onValuesChange,disabled:u,viewport:l,onViewportChange:this.onViewportChange,mapboxApiAccessToken:t.data.mapboxApiKey,mapStyle:r.mapbox_style,setControlValue:n,aggregation:!0},null!==r.metric&&O.a.createElement(C.a,{categories:d,position:r.legend_position,format:r.legend_format})))}}],[{key:\"getDerivedStateFromProps\",value:function(e,t){if(t&&e.payload.form_data===t.formData)return null;var r=e.payload.data.features||[],n=r.map(function(e){return e.__timestamp}),a=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||\"P1D\",o=Object(M.a)(n,a);return{start:o.start,end:o.end,getStep:o.getStep,values:o.values,disabled:o.disabled,viewport:e.formData.autozoom?Object(F.b)(e.viewport,function(e){return e.map(function(e){return e.polygon}).flat()}(r)):e.viewport,selected:[],lastClick:0,formData:e.payload.form_data}}}]),t}(O.a.Component);G.propTypes=B,G.defaultProps={onAddFilter:function(){},setTooltip:function(){}};t.default=G},2977:function(e,t,r){\"use strict\";r.r(t);var n=r(11),a=r.n(n),o=r(48),i=r.n(o),c=r(13),s=r.n(c),u=r(17),l=r.n(u),p=r(14),f=r.n(p),d=r(15),b=r.n(d),g=r(10),y=r.n(g),h=r(16),m=r.n(h),v=r(237),O=r.n(v),j=r(1),w=r.n(j),_=r(0),P=r.n(_),C=r(169),k=r(2596),S=r(194),E=r(2698),D=r(2700),V=r(2701),x=r(2699),A=r(2702),L=r(2697),T=r(2674),R=r(2722),q={deck_grid:E.getLayer,deck_screengrid:D.getLayer,deck_path:V.getLayer,deck_hex:x.getLayer,deck_scatter:A.getLayer,deck_geojson:L.getLayer,deck_arc:T.getLayer,deck_polygon:R.getLayer};function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var N={formData:P.a.object.isRequired,payload:P.a.object.isRequired,setControlValue:P.a.func.isRequired,viewport:P.a.object.isRequired,onAddFilter:P.a.func,setTooltip:P.a.func,onSelect:P.a.func},I=function(e){function t(e){var r;return s()(this,t),(r=f()(this,b()(t).call(this,e))).state={subSlicesLayers:{}},r.onViewportChange=r.onViewportChange.bind(y()(r)),r}return m()(t,e),l()(t,[{key:\"componentDidMount\",value:function(){var e=this.props,t=e.formData,r=e.payload;this.loadLayers(t,r)}},{key:\"componentWillReceiveProps\",value:function(e){var t=e.formData,r=e.payload;!O()(this.props.formData.deck_slices,e.formData.deck_slices)&&this.loadLayers(t,r)}},{key:\"onViewportChange\",value:function(e){this.setState({viewport:e})}},{key:\"loadLayers\",value:function(e,t,r){var n=this;this.setState({subSlicesLayers:{},viewport:r}),t.data.slices.forEach(function(t){var r=[].concat(i()(t.form_data.filters||[]),i()(e.filters||[]),i()(e.extra_filters||[])),o=M({},t,{form_data:M({},t.form_data,{filters:r})});C.a.get({endpoint:Object(S.d)(o.form_data,\"json\")}).then(function(e){var t=e.json,r=q[o.form_data.viz_type](o.form_data,t,n.props.onAddFilter,n.props.setTooltip,[],n.props.onSelect);n.setState({subSlicesLayers:M({},n.state.subSlicesLayers,a()({},o.slice_id,r))})}).catch(function(){})})}},{key:\"render\",value:function(){var e=this.props,t=e.payload,r=e.formData,n=e.setControlValue,a=this.state.subSlicesLayers,o=Object.values(a);return w.a.createElement(k.a,{mapboxApiAccessToken:t.data.mapboxApiKey,viewport:this.state.viewport||this.props.viewport,onViewportChange:this.onViewportChange,layers:o,mapStyle:r.mapbox_style,setControlValue:n})}}]),t}(w.a.PureComponent);I.propTypes=N,I.defaultProps={onAddFilter:function(){},setTooltip:function(){},onSelect:function(){}};t.default=I},569:function(e,t,r){\"use strict\";r.d(t,\"b\",function(){return n}),r.d(t,\"a\",function(){return a});var n=function(){var e=document.getElementById(\"app\");if(!e)return[];var t=JSON.parse(e.getAttribute(\"data-bootstrap\")),r=new Set([location.hostname]);return t&&t.common&&t.common.conf&&t.common.conf.SUPERSET_WEBSERVER_DOMAINS&&t.common.conf.SUPERSET_WEBSERVER_DOMAINS.forEach(function(e){r.add(e)}),Array.from(r)}(),a=n.length>1},69:function(e,t,r){\"use strict\";r.d(t,\"b\",function(){return n}),r.d(t,\"a\",function(){return a}),r.d(t,\"c\",function(){return o}),r.d(t,\"d\",function(){return i}),r.d(t,\"e\",function(){return c}),r.d(t,\"f\",function(){return s});r(66);function n(e,t){for(var r=[],n=e;n<=t;n++)r.push([n,n.toString()]);return r}function a(e){return e.map(function(e){return[e,e.toString()]})}function o(e,t){return\"\".concat(e,\"__\").concat(t)}function i(e){var t=e.replace(/[\\[]/,\"\\\\[\").replace(/[\\]]/,\"\\\\]\"),r=new RegExp(\"[\\\\?&]\"+t+\"=([^&#]*)\").exec(location.search);return null===r?\"\":decodeURIComponent(r[1].replace(/\\+/g,\" \"))}function c(e){var t;return e&&e.length>0&&(e.forEach(function(e){\"count\"===e.metric_name&&(t=\"count\")}),t||(t=e[0].metric_name)),t}function s(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)}},847:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n}),r.d(t,\"b\",function(){return o});r(69);var n={longitude:6.85236157047845,latitude:31.222656842808707,zoom:1,bearing:0,pitch:0},a=1609.34;function o(e,t){return\"square_m\"===e?Math.sqrt(t/Math.PI):\"radius_m\"===e?t:\"radius_km\"===e?1e3*t:\"radius_miles\"===e?t*a:\"square_km\"===e?1e3*Math.sqrt(t/Math.PI):\"square_miles\"===e?Math.sqrt(t/Math.PI)*a:null}}}]);","extractedComments":[]}