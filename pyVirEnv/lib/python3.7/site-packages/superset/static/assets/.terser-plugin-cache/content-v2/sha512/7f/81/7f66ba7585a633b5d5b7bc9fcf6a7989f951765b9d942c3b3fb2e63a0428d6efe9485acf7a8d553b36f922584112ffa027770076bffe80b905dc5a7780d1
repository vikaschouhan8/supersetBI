{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1298:function(e,t,n){\"use strict\";n.d(t,\"a\",function(){return s});var r=n(1),a=n.n(r),o=n(1814),i=n.n(o);n(2083),n(1831);function s(e){return a.a.createElement(\"span\",{className:\"BootstrapSliderWrapper\"},a.a.createElement(i.a,e))}},1831:function(e,t,n){},2588:function(e,t,n){\"use strict\";n.d(t,\"b\",function(){return f}),n.d(t,\"a\",function(){return d}),n.d(t,\"c\",function(){return v});var r=n(11),a=n.n(r),o=n(2786),i=n(22),s=n(2589);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var c=.25,l={LAT_MIN:-90,LAT_MAX:90,LNG_MIN:-180,LNG_MAX:180};function p(e){var t=i.extent(e,function(e){return e[1]}),n=i.extent(e,function(e){return e[0]}),r=t[0]===t[1]?function(e){return[e[0]-c<l.LAT_MIN?l.LAT_MIN:e[0]-c,e[1]+c>l.LAT_MAX?l.LAT_MAX:e[1]+c]}(t):t,a=n[0]===n[1]?function(e){return[e[0]-c<l.LNG_MIN?l.LNG_MIN:e[0]-c,e[1]+c>l.LNG_MAX?l.LNG_MAX:e[1]+c]}(n):n;return[[a[0],r[0]],[a[1],r[1]]]}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var r=p(t);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach(function(t){a()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{},Object(o.a)({height:e.height,width:e.width,padding:n,bounds:r}))}catch(t){return console.error(\"Could not auto zoom\",t),e}}function d(e,t,n,r){var a,o,i=e,u=n;return i.js_tooltip&&(u=Object(s.a)(i.js_tooltip)),u&&(a=function(e){e.picked?t({content:u(e),x:e.x,y:e.y+30}):t(null)}),i.js_onclick_href?o=function(e){var t=Object(s.a)(i.js_onclick_href)(e);window.open(t)}:i.table_filter&&void 0!==r&&(o=function(e){return r(e.object[i.line_column])}),{onClick:o,onHover:a,pickable:Boolean(a)}}var h={p1:.01,p5:.05,p95:.95,p99:.99};function v(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"sum\",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return\"count\"===t?function(e){return e.length}:(e=t in h?function(e,r){var a;return a=n?e.sort(function(e,t){return i.ascending(n(e),n(t))}):e.sort(i.ascending),i.quantile(a,h[t],r)}:i[t],n?function(t){return e(t.map(n))}:function(t){return e(t)})}},2589:function(e,t,n){\"use strict\";n.d(t,\"a\",function(){return d});var r=n(11),a=n.n(r),o=n(2622),i=n.n(o),s=n(2623),u=n.n(s),c=n(22),l=n(2592);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var f={console:console,_:u.a,colors:l,d3array:c};function d(e,t,n){var r={},o=\"SAFE_EVAL_\"+Math.floor(1e6*Math.random());r[o]={};var s=o+\"=\"+e,u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach(function(t){a()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},f,{},t);Object.keys(u).forEach(function(e){r[e]=u[e]});try{return i.a.runInNewContext(s,r,n),r[o]}catch(e){return function(){return e}}}},2592:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"hexToRGB\",function(){return a});var r=n(59);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;if(!e)return[0,0,0,t];var n=Object(r.f)(e);return[n.r,n.g,n.b,t]}},2596:function(e,t,n){\"use strict\";n.d(t,\"a\",function(){return E});var r=n(55),a=n.n(r),o=n(11),i=n.n(o),s=n(13),u=n.n(s),c=n(17),l=n.n(c),p=n(14),f=n.n(p),d=n(15),h=n.n(d),v=n(10),b=n.n(v),g=n(16),y=n.n(g),m=n(237),w=n.n(m),O=n(1),j=n.n(O),C=n(0),k=n.n(C),P=n(2616),_=n(2597);n(2618),n(2605);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(n,!0).forEach(function(t){i()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var S=2e3,D={viewport:k.a.object.isRequired,layers:k.a.array.isRequired,setControlValue:k.a.func,mapStyle:k.a.string,mapboxApiAccessToken:k.a.string.isRequired,onViewportChange:k.a.func},E=function(e){function t(e){var n;return u()(this,t),(n=f()(this,h()(t).call(this,e))).tick=n.tick.bind(b()(n)),n.onViewportChange=n.onViewportChange.bind(b()(n)),n.state={previousViewport:e.viewport,timer:setInterval(n.tick,S)},n}return y()(t,e),l()(t,[{key:\"componentWillUnmount\",value:function(){clearInterval(this.state.timer)}},{key:\"onViewportChange\",value:function(e){var t=Object.assign({},e),n=A({},this.state.previousViewport,{},t);this.props.onViewportChange(n)}},{key:\"tick\",value:function(){var e=this;if(this.state&&!w()(this.state.previousViewport,this.props.viewport)){var t=this.props.setControlValue,n=this.props.viewport;t&&t(\"viewport\",n),this.setState(function(){return{previousViewport:e.props.viewport}})}}},{key:\"layers\",value:function(){return this.props.layers.some(function(e){return\"function\"==typeof e})?this.props.layers.map(function(e){return\"function\"==typeof e?e():e}):this.props.layers}},{key:\"render\",value:function(){var e=this.props.viewport;return j.a.createElement(P.b,a()({},e,{mapStyle:this.props.mapStyle,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiAccessToken}),j.a.createElement(_.i,a()({},e,{layers:this.layers(),initWebGLParameters:!0})))}}],[{key:\"getDerivedStateFromProps\",value:function(e,t){return e.viewport!==t.viewport?{viewport:A({},e.viewport),previousViewport:t.viewport}:null}}]),t}(j.a.Component);E.propTypes=D,E.defaultProps={mapStyle:\"light\",onViewportChange:function(){},setControlValue:function(){}}},2599:function(e,t,n){\"use strict\";n.d(t,\"a\",function(){return y});var r=n(13),a=n.n(r),o=n(17),i=n.n(o),s=n(14),u=n.n(s),c=n(15),l=n.n(c),p=n(16),f=n.n(p),d=n(1),h=n.n(d),v=n(0),b=n.n(v),g={label:b.a.string.isRequired,value:b.a.string.isRequired},y=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return f()(t,e),i()(t,[{key:\"render\",value:function(){return h.a.createElement(\"div\",null,this.props.label,h.a.createElement(\"strong\",null,this.props.value))}}]),t}(h.a.PureComponent);y.propTypes=g},2605:function(e,t,n){},2606:function(e,t,n){\"use strict\";n.d(t,\"a\",function(){return c});var r=n(48),a=n.n(r),o=n(8),i=n.n(o),s=[1,0,1,0,0,0,0];function u(e,t){var n=parseInt(i()(t).format(\"x\"),10);return parseInt(i()(t).add(e).format(\"x\"),10)-n}var c=function(e,t){var n,r,o=i()(Math.min.apply(Math,a()(e))),c=i()(Math.max.apply(Math,a()(e)));if(-1!==t.indexOf(\"/\")){var l=t.split(\"/\",2);l[0].endsWith(\"Z\")?(r=i()(l[0]),n=i.a.duration(l[1])):(r=i()(l[1]),n=i.a.duration(l[0]))}else r=function(e,t){var n=i()(e).subtract(t),r=e.toArray(),a=n.toArray(),o=r.map(function(e,t){return a[t]!==e}).indexOf(!0),u=r.map(function(e,t){if(t===o){var n=e-a[t];return e-(e-s[t])%n}return t<o||-1===o?e:s[t]});return i()(u)}(o,n=i.a.duration(t));for(var p=i()(r);p<o;)p.add(n);for(;p>o;)p.subtract(n);for(var f=i()(r);f>c;)f.subtract(n);for(;f<c;)f.add(n);var d=null!=t?[p,i()(p).add(n)]:[p,f],h=e.every(function(e){return null===e});return{start:parseInt(p.format(\"x\"),10),end:parseInt(f.format(\"x\"),10),getStep:u.bind(this,n),values:d.map(function(e){return parseInt(e.format(\"x\"),10)}),disabled:h}}},2607:function(e,t,n){\"use strict\";var r=n(11),a=n.n(r),o=n(13),i=n.n(o),s=n(17),u=n.n(s),c=n(14),l=n.n(c),p=n(15),f=n.n(p),d=n(10),h=n.n(d),v=n(16),b=n.n(v),g=n(1),y=n.n(g),m=n(0),w=n.n(m),O=n(2596),j=n(1299),C=n.n(j),k=n(35),P=n(1298),_=(n(2608),{start:w.a.number.isRequired,step:w.a.number.isRequired,end:w.a.number.isRequired,values:w.a.array.isRequired,onChange:w.a.func,loopDuration:w.a.number,maxFrames:w.a.number,orientation:w.a.oneOf([\"horizontal\",\"vertical\"]),reversed:w.a.bool,disabled:w.a.bool,range:w.a.bool}),V=function(e){function t(e){var n;i()(this,t),(n=l()(this,f()(t).call(this,e))).state={intervalId:null};var r=e.end-e.start,a=Math.min(e.maxFrames,r/e.step),o=r/a;return n.intervalMilliseconds=e.loopDuration/a,n.increment=o<e.step?e.step:o-o%e.step,n.onChange=n.onChange.bind(h()(n)),n.play=n.play.bind(h()(n)),n.pause=n.pause.bind(h()(n)),n.stepBackward=n.stepBackward.bind(h()(n)),n.stepForward=n.stepForward.bind(h()(n)),n.getPlayClass=n.getPlayClass.bind(h()(n)),n.formatter=n.formatter.bind(h()(n)),n}return b()(t,e),u()(t,[{key:\"componentDidMount\",value:function(){C.a.bind([\"space\"],this.play)}},{key:\"componentWillUnmount\",value:function(){C.a.unbind([\"space\"])}},{key:\"onChange\",value:function(e){this.props.onChange(e.target.value),null!=this.state.intervalId&&this.pause()}},{key:\"getPlayClass\",value:function(){return null==this.state.intervalId?\"fa fa-play fa-lg slider-button\":\"fa fa-pause fa-lg slider-button\"}},{key:\"play\",value:function(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{var e=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:e})}}},{key:\"pause\",value:function(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}},{key:\"stepForward\",value:function(){var e=this,t=this.props,n=t.start,r=t.end,a=t.step,o=t.values;if(!t.disabled){var i=(Array.isArray(o)?o:[o,o+a]).map(function(t){return t+e.increment}),s=i[1]>r?i[0]-n:0;this.props.onChange(i.map(function(e){return e-s}))}}},{key:\"stepBackward\",value:function(){var e=this,t=this.props,n=t.start,r=t.end,a=t.step,o=t.values;if(!t.disabled){var i=(Array.isArray(o)?o:[o,o+a]).map(function(t){return t-e.increment}),s=i[0]<n?r-i[1]:0;this.props.onChange(i.map(function(e){return e+s}))}}},{key:\"formatter\",value:function(e){if(this.props.disabled)return Object(k.b)(\"Data has no time steps\");var t=e;return Array.isArray(e)?e[0]===e[1]&&(t=[e[0]]):t=[e],t.map(function(e){return new Date(e).toUTCString()}).join(\" : \")}},{key:\"render\",value:function(){var e=this.props,t=e.start,n=e.end,r=e.step,a=e.orientation,o=e.reversed,i=e.disabled,s=e.range,u=e.values;return y.a.createElement(\"div\",{className:\"play-slider\"},y.a.createElement(\"div\",{className:\"play-slider-controls padded\"},y.a.createElement(\"i\",{className:\"fa fa-step-backward fa-lg slider-button \",onClick:this.stepBackward}),y.a.createElement(\"i\",{className:this.getPlayClass(),onClick:this.play}),y.a.createElement(\"i\",{className:\"fa fa-step-forward fa-lg slider-button \",onClick:this.stepForward})),y.a.createElement(\"div\",{className:\"play-slider-scrobbler padded\"},y.a.createElement(P.a,{value:s?u:u[0],range:s,formatter:this.formatter,change:this.onChange,min:t,max:n,step:r,orientation:a,reversed:o,disabled:i?\"disabled\":\"enabled\"})))}}]),t}(y.a.PureComponent);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(n,!0).forEach(function(t){a()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}V.propTypes=_,V.defaultProps={onChange:function(){},loopDuration:15e3,maxFrames:100,orientation:\"horizontal\",reversed:!1,disabled:!1,range:!0},n.d(t,\"a\",function(){return E});var D={getLayers:w.a.func.isRequired,start:w.a.number.isRequired,end:w.a.number.isRequired,getStep:w.a.func,values:w.a.array.isRequired,aggregation:w.a.bool,disabled:w.a.bool,viewport:w.a.object.isRequired,children:w.a.node,mapStyle:w.a.string,mapboxApiAccessToken:w.a.string.isRequired,setControlValue:w.a.func,onViewportChange:w.a.func,onValuesChange:w.a.func},E=function(e){function t(e){var n;return i()(this,t),(n=l()(this,f()(t).call(this,e))).onViewportChange=n.onViewportChange.bind(h()(n)),n}return b()(t,e),u()(t,[{key:\"onViewportChange\",value:function(e){var t=this.props.disabled?S({},e):S({},e,{height:e.height+20});this.props.onViewportChange(t)}},{key:\"render\",value:function(){var e=this.props,t=e.start,n=e.end,r=e.getStep,a=e.disabled,o=e.aggregation,i=e.children,s=e.getLayers,u=e.values,c=e.onValuesChange,l=e.viewport,p=e.setControlValue,f=e.mapStyle,d=e.mapboxApiAccessToken,h=s(u),v=S({},l,{height:a?l.height:l.height-20});return y.a.createElement(\"div\",null,y.a.createElement(O.a,{viewport:v,layers:h,setControlValue:p,mapStyle:f,mapboxApiAccessToken:d,onViewportChange:this.onViewportChange}),!a&&y.a.createElement(V,{start:t,end:n,step:r(t),values:u,range:!o,onChange:c}),i)}}]),t}(y.a.Component);E.propTypes=D,E.defaultProps={aggregation:!1,disabled:!1,mapStyle:\"light\",setControlValue:function(){},onViewportChange:function(){},onValuesChange:function(){}}},2608:function(e,t,n){},2619:function(e,t){},2620:function(e,t){},2621:function(e,t){},2700:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"getLayer\",function(){return E});var r=n(13),a=n.n(r),o=n(17),i=n.n(o),s=n(14),u=n.n(s),c=n(15),l=n.n(c),p=n(10),f=n.n(p),d=n(16),h=n.n(d),v=n(11),b=n.n(v),g=n(1),y=n.n(g),m=n(0),w=n.n(m),O=n(2597),j=n(35),C=n(2607),k=n(2606),P=n(2589),_=n(2588),V=n(2599);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(n,!0).forEach(function(t){b()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function D(e){return y.a.createElement(\"div\",{className:\"deckgl-tooltip\"},y.a.createElement(V.a,{label:\"\".concat(Object(j.b)(\"Longitude and Latitude\"),\": \"),value:\"\".concat(e.object.position[0],\", \").concat(e.object.position[1])}),y.a.createElement(V.a,{label:\"\".concat(Object(j.b)(\"Weight\"),\": \"),value:\"\".concat(e.object.weight)}))}function E(e,t,n,r,a,o,i){var s=e,u=s.color_picker,c=t.data.features.map(function(e){return S({},e,{color:[u.r,u.g,u.b,255*u.a]})});if(s.js_data_mutator){var l=Object(P.a)(s.js_data_mutator);c=l(c)}return null!=i&&i.forEach(function(e){c=c.filter(e)}),new O.h(S({id:\"screengrid-layer-\".concat(s.slice_id),data:c,pickable:!0,cellSizePixels:s.grid_size,minColor:[u.r,u.g,u.b,0],maxColor:[u.r,u.g,u.b,255*u.a],outline:!1,getWeight:function(e){return e.weight||0}},Object(_.a)(s,r,D)))}var x={formData:w.a.object.isRequired,payload:w.a.object.isRequired,setControlValue:w.a.func.isRequired,viewport:w.a.object.isRequired,onAddFilter:w.a.func,setTooltip:w.a.func},L=function(e){function t(e){var n;return a()(this,t),(n=u()(this,l()(t).call(this,e))).state=t.getDerivedStateFromProps(e),n.getLayers=n.getLayers.bind(f()(n)),n.onValuesChange=n.onValuesChange.bind(f()(n)),n.onViewportChange=n.onViewportChange.bind(f()(n)),n}return h()(t,e),i()(t,[{key:\"onValuesChange\",value:function(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})}},{key:\"onViewportChange\",value:function(e){this.setState({viewport:e})}},{key:\"getLayers\",value:function(e){var t=[];return e[0]===e[1]||e[1]===this.end?t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]}),[E(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip)]}},{key:\"render\",value:function(){var e=this.props,t=e.formData,n=e.payload,r=e.setControlValue;return y.a.createElement(\"div\",null,y.a.createElement(C.a,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,onValuesChange:this.onValuesChange,disabled:this.state.disabled,viewport:this.state.viewport,onViewportChange:this.onViewportChange,mapboxApiAccessToken:n.data.mapboxApiKey,mapStyle:t.mapbox_style,setControlValue:r,aggregation:!0}))}}],[{key:\"getDerivedStateFromProps\",value:function(e,t){if(t&&e.payload.form_data===t.formData)return null;var n=e.payload.data.features||[],r=n.map(function(e){return e.__timestamp}),a=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||\"P1D\",o=Object(k.a)(r,a);return{start:o.start,end:o.end,getStep:o.getStep,values:o.values,disabled:o.disabled,viewport:e.formData.autozoom?Object(_.b)(e.viewport,n.map(function(e){return e.position})):e.viewport,selected:[],lastClick:0,formData:e.payload.form_data}}}]),t}(y.a.PureComponent);L.propTypes=x,L.defaultProps={onAddFilter:function(){},setTooltip:function(){}},t.default=L}}]);","extractedComments":[]}